-- ===================================
-- SCRIPT DE VERIFICAÇÃO - MIGRATIONS
-- ===================================

-- 1. Verificar se as tabelas existem
SELECT 
    'RM98047_97648_CLIENTE' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_CLIENTE'
UNION ALL
SELECT 
    'RM98047_97648_IMOVEL' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_IMOVEL'
UNION ALL
SELECT 
    'RM98047_97648_PRODUTO' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_PRODUTO'
UNION ALL
SELECT 
    'RM98047_97648_USUARIO' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_USUARIO'
UNION ALL
SELECT 
    'RM98047_97648_CONTRATO' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_CONTRATO'
UNION ALL
SELECT 
    'RM98047_97648_VISITA' AS TABELA,
    COUNT(*) AS EXISTE
FROM USER_TABLES 
WHERE TABLE_NAME = 'RM98047_97648_VISITA';

-- 2. Verificar tabela de histórico de migrations
SELECT * FROM "__EFMIGRATIONSHISTORY" ORDER BY "AppliedOn" DESC;

-- 3. Contar registros em cada tabela
SELECT 'CLIENTE' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_CLIENTE
UNION ALL
SELECT 'IMOVEL' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_IMOVEL
UNION ALL
SELECT 'PRODUTO' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_PRODUTO
UNION ALL
SELECT 'USUARIO' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_USUARIO
UNION ALL
SELECT 'CONTRATO' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_CONTRATO
UNION ALL
SELECT 'VISITA' AS TABELA, COUNT(*) AS TOTAL FROM RM98047_97648_VISITA;

-- 4. Verificar estrutura das tabelas
SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE, DATA_LENGTH
FROM USER_TAB_COLUMNS
WHERE TABLE_NAME LIKE 'RM98047_97648_%'
ORDER BY TABLE_NAME, COLUMN_ID;

-- 5. Verificar constraints
SELECT 
    CONSTRAINT_NAME,
    CONSTRAINT_TYPE,
    TABLE_NAME,
    STATUS
FROM USER_CONSTRAINTS
WHERE TABLE_NAME LIKE 'RM98047_97648_%'
ORDER BY TABLE_NAME, CONSTRAINT_TYPE;

-- 6. Verificar sequences
SELECT SEQUENCE_NAME, LAST_NUMBER
FROM USER_SEQUENCES
WHERE SEQUENCE_NAME LIKE 'SEQ_RM98047_97648_%';
